<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Annual Report Crawler - Web Interface</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
        }
        
        .header .nav-link {
            position: absolute;
            top: 20px;
            right: 30px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            text-decoration: none;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        .header .nav-link:hover {
            background: rgba(255, 255, 255, 0.3);
            color: white;
            text-decoration: none;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        .header .author {
            font-size: 1em;
            opacity: 0.8;
            font-style: italic;
        }

        .content {
            padding: 40px;
        }

        h2 {
            color: #2c3e50;
            font-size: 1.8em;
            margin: 30px 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        h3 {
            color: #34495e;
            font-size: 1.4em;
            margin: 25px 0 15px 0;
        }

        h4 {
            color: #34495e;
            font-size: 1.2em;
            margin: 20px 0 10px 0;
        }

        p {
            margin-bottom: 15px;
            text-align: justify;
        }

        ul, ol {
            margin: 15px 0;
            padding-left: 30px;
        }

        li {
            margin-bottom: 8px;
        }

        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .feature-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .feature-item strong {
            color: #667eea;
            display: block;
            margin-bottom: 5px;
        }

        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9em;
        }

        pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        }

        pre code {
            background: none;
            padding: 0;
            color: inherit;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e1e5e9;
        }

        th {
            background: #667eea;
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            margin: 30px 0;
        }

        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }

        .warning::before {
            content: "⚠️ ";
            font-weight: bold;
        }

        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }

        .info::before {
            content: "ℹ️ ";
            font-weight: bold;
        }

        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }

        .success::before {
            content: "✅ ";
            font-weight: bold;
        }

        .changelog {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .changelog h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .changelog ul {
            list-style: none;
            padding-left: 0;
        }

        .changelog li {
            padding: 5px 0;
            border-left: 3px solid #667eea;
            padding-left: 15px;
            margin-bottom: 5px;
        }

        .toc {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .toc h3 {
            margin-top: 0;
            color: #667eea;
        }

        .toc ul {
            list-style: none;
            padding-left: 0;
        }

        .toc li {
            margin-bottom: 5px;
        }

        .toc a {
            color: #667eea;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 5px;
            display: block;
            transition: background-color 0.3s;
        }

        .toc a:hover {
            background: #667eea;
            color: white;
        }

        .footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 30px;
            margin-top: 40px;
        }

        .btn {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            margin: 10px 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
            color: white;
            text-decoration: none;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .content {
                padding: 20px;
            }
            
            .feature-list {
                grid-template-columns: 1fr;
            }
            
            table {
                font-size: 0.9em;
            }
            
            th, td {
                padding: 8px 10px;
            }
        }

        .highlight {
            background: linear-gradient(120deg, #a8edea 0%, #fed6e3 100%);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }

        .emoji {
            font-size: 1.2em;
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="/" class="nav-link">🌐 返回Web界面</a>
            <h1>📊 Annual Report Crawler</h1>
            <p>Developed by Terence WANG</p>
        </div>

        <div class="content">
            <div class="toc">
                <h3>📋 目录</h3>
                <ul>
                    <li><a href="#introduction">项目介绍</a></li>
                    <li><a href="#features">核心功能</a></li>
                    <li><a href="#installation">部署与安装</a></li>
                    <li><a href="#usage">使用指南</a></li>
                    <li><a href="#output">输出说明</a></li>
                    <li><a href="#technical">技术实现</a></li>
                    <li><a href="#structure">项目结构</a></li>
                    <li><a href="#notes">注意事项</a></li>
                    <li><a href="#changelog">更新日志</a></li>
                </ul>
            </div>

            <section id="introduction">
                <h2>🎯 项目介绍</h2>
                <p>这是一个功能强大的Python脚本，由<span class="highlight">Terence Wang</span>开发，旨在从多个数据源批量下载上市公司年报，以供后续进一步分析使用。</p>
                
                <div class="info">
                    本项目支持A股（主板、科创板、创业板）、港股、美股等多个市场的年报下载，并提供Web界面和命令行两种使用方式。
                </div>
            </section>

            <section id="features">
                <h2>🚀 核心功能</h2>
                <div class="feature-list">
                    <div class="feature-item">
                        <strong>🚀 全市场支持</strong>
                        支持A股（主板、科创板、创业板）、港股、美股。
                    </div>
                    <div class="feature-item">
                        <strong>📊 智能识别</strong>
                        自动根据股票代码格式识别市场及板块。
                    </div>
                    <div class="feature-item">
                        <strong>📥 批量下载</strong>
                        支持通过交互式Web界面或命令行进行批量下载。
                    </div>
                    <div class="feature-item">
                        <strong>📅 灵活年份</strong>
                        支持单年份、年份范围或不连续年份列表。
                    </div>
                    <div class="feature-item">
                        <strong>🌐 Web界面</strong>
                        提供现代化、响应式的Web界面，操作直观，实时反馈进度。
                    </div>
                    <div class="feature-item">
                        <strong>📄 多格式支持</strong>
                        A股和港股下载为PDF格式，美股下载为HTML格式的10-K报告。
                    </div>
                    <div class="feature-item">
                        <strong>📈 详细报告</strong>
                        任务完成后提供详细的下载统计与失败原因分析。
                    </div>
                </div>
            </section>

            <section id="installation">
                <h2>⚙️ 部署与安装</h2>
                
                <h3>1. 基础环境</h3>
                <ul>
                    <li><strong>Python</strong>: 3.7+</li>
                    <li><strong>安装依赖包</strong>:</li>
                </ul>
                <pre><code>pip install -r requirements.txt</code></pre>

                <h3>2. 浏览器与驱动 (必需：用于科创板、创业板、港股)</h3>
                <p>这些市场的年报下载依赖于 <a href="https://www.selenium.dev/" target="_blank">Selenium</a> 自动化浏览器操作。</p>
                
                <div class="warning">
                    请确保您已安装 <strong>Google Chrome</strong> 浏览器。
                </div>

                <h4>驱动程序 (ChromeDriver)</h4>
                <ul>
                    <li><strong>自动安装</strong>: 脚本在首次运行时会尝试自动下载与您Chrome版本匹配的ChromeDriver。请优先尝试此方式。</li>
                    <li><strong>手动安装</strong>: 如果自动下载失败（例如网络问题），请遵循以下步骤：
                        <ol>
                            <li><strong>查看Chrome版本</strong>: 在浏览器地址栏输入 <code>chrome://version/</code> 并回车</li>
                            <li><strong>下载驱动</strong>: 访问 <a href="https://googlechromelabs.github.io/chrome-for-testing/" target="_blank">ChromeDriver 官方镜像</a></li>
                            <li><strong>配置路径</strong>: 将驱动添加到系统PATH中</li>
                            <li><strong>验证</strong>: 运行 <code>chromedriver --version</code> 检查安装</li>
                        </ol>
                    </li>
                </ul>

                <div class="info">
                    <strong>注意</strong>: 美股10-K报告直接以HTML格式保存，无需额外的PDF转换工具。
                </div>
            </section>

            <section id="usage">
                <h2>📖 使用指南</h2>
                
                <h3>方式一：Web界面 (推荐)</h3>
                <div class="success">
                    提供一个直观、实时、对新手友好的操作界面。
                </div>

                <h4>启动步骤</h4>
                <ol>
                    <li><strong>启动服务</strong>:
                        <ul>
                            <li><strong>Windows</strong>: 直接双击运行 <code>start_web.bat</code></li>
                            <li><strong>macOS / Linux</strong>: 运行 <code>./start_web.sh</code></li>
                            <li><strong>手动</strong>: <code>python web_app_simple.py</code></li>
                        </ul>
                    </li>
                    <li><strong>访问界面</strong>: 浏览器自动打开 <code>http://127.0.0.1:5000</code></li>
                </ol>

                <h4>界面说明</h4>
                <div class="info">
                    <strong>数据源说明</strong>:<br>
                    • <strong>A股/港股</strong>: 数据来自巨潮资讯网，下载格式为PDF（可能有缺漏）<br>
                    • <strong>美股</strong>: 数据来自美国证券交易委员会 (SEC) 的10-K文件，下载格式为HTML
                </div>

                <h3>方式二：命令行</h3>
                <p>适合需要自动化或集成到其他脚本中的高级用户。</p>

                <h4>命令格式</h4>
                <pre><code>python annual_report_downloader.py [-h] (-s STOCK | -f FILE) -y YEARS [-d DIR]</code></pre>

                <h4>参数详解</h4>
                <table>
                    <thead>
                        <tr>
                            <th>参数</th>
                            <th>描述</th>
                            <th>必需</th>
                            <th>示例</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>-s, --stock</code></td>
                            <td>单个股票代码</td>
                            <td>与<code>-f</code>互斥</td>
                            <td><code>-s 000001</code></td>
                        </tr>
                        <tr>
                            <td><code>-f, --file</code></td>
                            <td>股票代码文件路径</td>
                            <td>与<code>-s</code>互斥</td>
                            <td><code>-f stocks.txt</code></td>
                        </tr>
                        <tr>
                            <td><code>-y, --years</code></td>
                            <td>年份（单年、范围、列表）</td>
                            <td><strong>是</strong></td>
                            <td><code>-y 2023</code></td>
                        </tr>
                        <tr>
                            <td><code>-d, --dir</code></td>
                            <td>下载目录</td>
                            <td>否</td>
                            <td><code>-d ./reports</code></td>
                        </tr>
                    </tbody>
                </table>

                <h4>使用示例</h4>
                <pre><code># 下载平安银行2023年年报
python annual_report_downloader.py -s 000001 -y 2023

# 下载宁德时代2021至2023的年报
python annual_report_downloader.py -s 300750 -y 2021-2023

# 批量下载文件中的所有股票的2023年报
python annual_report_downloader.py -f all_types_test_stocks.txt -y 2023</code></pre>
            </section>

            <section id="output">
                <h2>📁 输出说明</h2>
                
                <h3>文件结构</h3>
                <p>默认情况下，下载的报告会按市场分类存放在 <code>annual_reports</code> 目录中：</p>
                <pre><code>annual_reports/
├── A股主板/
│   └── 000001_平安银行_2023年报.pdf
├── A股科创板/
│   └── 688111_金山办公_2023年报.pdf
├── 港股/
│   └── 00700_腾讯控股_2023年报.pdf
└── US/
    └── AAPL_2023_10K_2023-11-03.html</code></pre>

                <h3>汇总报告</h3>
                <div class="info">
                    所有任务结束后，控制台会输出一份详细的统计报告，包括成功/失败计数、成功率以及失败任务的详细列表。
                </div>
            </section>

            <section id="technical">
                <h2>🔧 技术实现与常见问题</h2>
                
                <div class="section">
                    <h3>技术实现</h3>
                    <ul>
                        <li><strong>A股主板</strong>: 调用巨潮网公开API，直接获取PDF</li>
                        <li><strong>科创板/创业板/港股</strong>: 通过Selenium模拟浏览器操作，下载PDF</li>
                        <li><strong>美股</strong>: 调用SEC EDGAR接口，直接保存HTML格式的10-K报告</li>
                    </ul>
                </div>

                <div class="warning">
                    <strong>常见问题</strong>:<br>
                    • <strong>港股识别不准</strong>: 可能因发布格式变动而出错<br>
                    • <strong>下载中断</strong>: 请检查网络连接以及代理设置<br>
                    • <strong>ChromeDriver版本错误</strong>: 确保驱动版本与Chrome浏览器版本对应
                </div>
            </section>

            <section id="structure">
                <h2>📂 项目结构</h2>
                <pre><code>annual_report_crawler/
├── annual_report_downloader.py    # 主程序（命令行版本）
├── web_app.py                    # Web界面应用
├── start_web.bat                 # Windows Web启动脚本
├── start_web.sh                  # Linux/Mac Web启动脚本
├── templates/
│   └── index.html               # Web界面模板
├── requirements.txt             # Python依赖
├── all_types_test_stocks.txt    # 全类型股票测试文件
├── tests_and_examples/          # 测试脚本和示例（被gitignore）
├── annual_reports/              # 默认下载目录（被gitignore）
└── README.md                    # 本文件</code></pre>
            </section>

            <section id="notes">
                <h2>⚠️ 注意事项</h2>
                <div class="warning">
                    <ol>
                        <li><strong>合规使用</strong>: 本脚本仅用于学习和研究目的，请遵守相关网站的使用条款</li>
                        <li><strong>频率控制</strong>: 脚本内置了请求间隔，请勿修改以免被网站封禁</li>
                        <li><strong>数据准确性</strong>: 下载的文件请以官方发布为准</li>
                        <li><strong>环境要求</strong>: 确保Python环境和依赖包版本兼容</li>
                        <li><strong>文件格式</strong>: A股和港股为PDF格式，美股为HTML格式</li>
                        <li><strong>美股限制</strong>: SEC网站可能有访问限制，建议合理控制请求频率</li>
                    </ol>
                </div>
            </section>

            <section id="changelog">
                <h2>📝 更新日志</h2>
                
                <div class="changelog">
                    <h3>v2.1.1</h3>
                    <ul>
                        <li>🐛 修复Web界面中文编码问题</li>
                        <li>📝 更新版权年份到2025</li>
                        <li>🔧 增强文件读取的编码兼容性</li>
                    </ul>
                </div>

                <div class="changelog">
                    <h3>v2.1.0</h3>
                    <ul>
                        <li>✨ 新增Web界面功能！支持浏览器操作</li>
                        <li>🌐 提供用户友好的Web界面，无需命令行知识</li>
                        <li>📊 实时进度显示和运行日志</li>
                        <li>📥 Web界面一键下载文件功能</li>
                        <li>📱 响应式设计，支持手机和平板访问</li>
                        <li>🚀 简化使用流程：启动服务器 → 打开浏览器 → 开始下载</li>
                    </ul>
                </div>

                <div class="changelog">
                    <h3>v2.0.1</h3>
                    <ul>
                        <li>🐛 修复港股年报识别误判问题</li>
                        <li>📝 增强港股年报过滤逻辑，排除通知信函等非年报文档</li>
                        <li>✅ 确保港股下载的是真正的年度报告</li>
                    </ul>
                </div>

                <div class="changelog">
                    <h3>v2.0.0</h3>
                    <ul>
                        <li>✨ 新增美股10-K报告下载功能</li>
                        <li>✨ 支持真正的PDF格式输出</li>
                        <li>✨ 添加wkhtmltopdf和weasyprint PDF转换支持</li>
                        <li>🐛 修复返回值格式不统一的问题</li>
                        <li>📝 更新README和项目结构</li>
                        <li>🗂️ 整理测试文件到独立目录</li>
                    </ul>
                </div>

                <div class="changelog">
                    <h3>v1.0.0</h3>
                    <ul>
                        <li>初始版本发布</li>
                        <li>支持A股主板、科创板、创业板和港股</li>
                        <li>实现批量下载和进度显示</li>
                        <li>添加详细的错误处理和汇总报告</li>
                    </ul>
                </div>
            </section>
        </div>

        <div class="footer">
            <p>&copy; 2025 Annual Report Crawler - Developed by <strong>Terence Wang</strong></p>
            <p>本项目仅供学习和研究使用</p>
        </div>
    </div>

    <script>
        // 平滑滚动到锚点
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // 代码块复制功能
        document.querySelectorAll('pre code').forEach(block => {
            const button = document.createElement('button');
            button.className = 'copy-btn';
            button.textContent = '复制';
            button.style.cssText = `
                position: absolute;
                top: 10px;
                right: 10px;
                background: #667eea;
                color: white;
                border: none;
                padding: 5px 10px;
                border-radius: 4px;
                cursor: pointer;
                font-size: 12px;
            `;
            
            const pre = block.parentElement;
            pre.style.position = 'relative';
            pre.appendChild(button);
            
            button.addEventListener('click', () => {
                navigator.clipboard.writeText(block.textContent).then(() => {
                    button.textContent = '已复制!';
                    setTimeout(() => {
                        button.textContent = '复制';
                    }, 2000);
                });
            });
        });
    </script>
</body>
</html> 