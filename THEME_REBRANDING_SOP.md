# 主题重构标准操作程序 (SOP)

## 📋 概述

本文档提供了完整的项目主题重构操作流程，适用于需要更换主题名称、配色方案、视觉标识的项目。通过标准化的操作步骤，确保重构过程高效、完整且不遗漏任何细节。

---

## 🎯 适用场景

- 项目品牌重塑
- 主题配色更换  
- 模式名称变更
- 视觉标识升级
- 用户界面优化

---

## 🔄 操作流程

### 阶段一：规划与准备

#### 1.1 主题方案设计
- [ ] **确定新主题名称**
  - 定义主模式名称（如：Mizuki → Hanae）
  - 定义副模式名称（如：Otako → Shio）
  - 准备相关描述文本

- [ ] **制定配色方案**
  - 确定主模式颜色（CMYK/RGB/HEX值）
  - 确定副模式颜色（CMYK/RGB/HEX值）
  - 设计渐变色组合
  - 考虑可读性和对比度

- [ ] **准备功能配置**
  - 分配新的端口号（避免冲突）
  - 选择合适的emoji标识
  - 确定其他功能性变更

#### 1.2 文件清单梳理
- [ ] **识别需要修改的文件类型**
  - Python应用文件（*.py）
  - HTML模板文件（*.html）
  - 文档文件（*.md, *.html）
  - 配置文件（*.bat, *.txt）

- [ ] **建立文件修改清单**
  - 根目录文件
  - 子目录文件（如v1/）
  - 静态资源文件

### 阶段二：文字内容替换

#### 2.1 批量文字替换
- [ ] **主模式名称替换**
  ```bash
  # 使用search_replace工具批量替换
  旧名称 → 新名称（如：Mizuki → Hanae）
  ```

- [ ] **副模式名称替换**
  ```bash
  # 使用search_replace工具批量替换  
  旧名称 → 新名称（如：Otako → Shio）
  ```

- [ ] **验证替换完整性**
  - 使用grep_search确认无遗漏
  - 检查大小写变体
  - 验证上下文适配性

#### 2.2 Emoji和图标替换
- [ ] **更新emoji标识**
  - 主模式emoji（如：🎴 → 🌸）
  - 副模式emoji（如：🪻 → 🪸）

- [ ] **更新其他视觉标识**
  - 图标文件
  - 标识符号

### 阶段三：配色方案实施

#### 3.1 颜色映射表建立
创建旧颜色→新颜色的映射关系：

| 组件类型 | 旧色值 | 新色值 | 应用范围 |
|---------|--------|--------|----------|
| 主模式色 | #旧色值 | #新色值 | 按钮、边框、重点 |
| 副模式色 | #旧色值 | #新色值 | 按钮、边框、重点 |
| 渐变起始 | #旧色值 | #新色值 | 背景渐变 |
| 渐变结束 | #旧色值 | #新色值 | 背景渐变 |

#### 3.2 系统性颜色替换
- [ ] **页面头部背景**
  - 渐变色替换
  - 纯色背景替换

- [ ] **交互元素颜色**
  - 按钮背景色
  - 链接颜色  
  - 边框颜色
  - 悬浮效果颜色

- [ ] **状态指示颜色**
  - 进度条颜色
  - 选中状态颜色
  - 焦点状态颜色

- [ ] **装饰性颜色**
  - 分割线颜色
  - 阴影颜色
  - 高亮颜色

#### 3.3 RGBA值同步更新
- [ ] **半透明效果**
  - 按钮悬浮阴影
  - 背景透明度
  - 遮罩层颜色

### 阶段四：功能配置更新

#### 4.1 端口配置调整
- [ ] **应用端口更新**
  - 主应用端口
  - 各模式端口
  - 文档中的端口引用

- [ ] **启动脚本更新**
  - batch文件（*.bat）
  - shell脚本
  - 配置文件

#### 4.2 文档内容同步
- [ ] **README文件更新**
  - 主题名称
  - 配色说明
  - 使用指南

- [ ] **帮助文档更新**
  - 操作说明
  - 示例内容

### 阶段五：视觉优化处理

#### 5.1 可读性问题诊断
- [ ] **文字对比度检查**
  - 标题文字可读性
  - 按钮文字可读性
  - 链接文字可读性

- [ ] **背景兼容性验证**
  - 渐变背景 vs 文字颜色
  - 纯色背景 vs 文字颜色

#### 5.2 视觉效果优化方案

**方案A：深色背景方案**
- 将背景色调整为深色版本
- 使用白色文字
- 适用于：对比度要求高的场景

**方案B：半透明遮罩方案**
```css
background: 
    linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)),
    linear-gradient(原始渐变色);
color: white;
```

**方案C：文字描边方案**
```css
text-shadow: 
    1px 1px 3px rgba(0,0,0,0.4),
    0px 0px 8px rgba(0,0,0,0.3);
color: white;
```

#### 5.3 交互体验增强
- [ ] **按钮效果优化**
  - 悬浮状态
  - 点击反馈
  - 禁用状态

- [ ] **模式选择优化**
  - 选中状态突出
  - 边框加强
  - 阴影效果

### 阶段六：测试与验证

#### 6.1 功能测试
- [ ] **页面加载测试**
  - 所有页面正常显示
  - 样式加载完整
  - 无控制台错误

- [ ] **交互功能测试**
  - 按钮点击响应
  - 链接跳转正确
  - 表单提交正常

#### 6.2 视觉一致性检查
- [ ] **跨页面一致性**
  - 主应用页面
  - 文档页面
  - 子版本页面

- [ ] **跨浏览器兼容性**
  - Chrome测试
  - Firefox测试
  - Edge测试

#### 6.3 移动端适配验证
- [ ] **响应式布局**
  - 移动端显示
  - 平板端显示
  - 触摸交互

---

## 🛠️ 工具清单

### 必需工具
- `search_replace` - 批量文字替换
- `grep_search` - 内容搜索验证
- `read_file` - 文件内容查看
- `edit_file` - 文件编辑

### 辅助工具
- 颜色选择器（获取精确色值）
- 对比度检查工具
- 浏览器开发者工具

---

## ⚠️ 注意事项

### 操作原则
1. **备份优先**：操作前确保代码已提交到版本控制
2. **分步实施**：按阶段逐步进行，便于问题定位
3. **并行处理**：使用并行工具调用提高效率
4. **全面验证**：每个阶段完成后进行验证

### 常见陷阱
1. **内联样式覆盖**：注意HTML中的style属性可能覆盖CSS
2. **缓存问题**：测试时需要强制刷新浏览器缓存
3. **颜色格式不一致**：确保HEX、RGB、RGBA格式统一
4. **渐变方向**：注意渐变角度和方向的一致性

### 回滚方案
- 保持Git提交记录清晰
- 每个阶段单独提交
- 记录重要的配色参数
- 建立快速回滚检查点

---

## 📝 操作记录模板

```markdown
## 主题重构记录

**项目名称**：
**重构日期**：
**操作人员**：

### 变更内容
- 主模式：旧名称 → 新名称
- 副模式：旧名称 → 新名称  
- 主色调：#旧色值 → #新色值
- 副色调：#旧色值 → #新色值

### 修改文件清单
- [ ] 文件1
- [ ] 文件2
- [ ] ...

### 测试结果
- [ ] 功能测试通过
- [ ] 视觉检查通过
- [ ] 兼容性验证通过

### 遗留问题
- 问题1：描述及解决方案
- 问题2：描述及解决方案
```

---

**文档版本**：v1.0  
**最后更新**：2025年1月  
**维护人员**：开发团队

> 💡 **提示**：本SOP基于实际项目重构经验总结，建议根据具体项目特点进行调整和优化。 