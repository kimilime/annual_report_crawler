# Annual Report Crawler - Unified "Hysilens" Version v2

**版本: 2.0.0 (统一"Hysilens"版本)**

一个功能强大的年报下载工具，支持A股、港股和美股。**v2版本整合了两种下载模式到统一界面**，让用户智能选择最适合的下载方式。

**开发者:** Terence WANG

---

## 🎉 v2版本特色

### 🔧 统一"Hysilens"版本优势

**v2版本**整合了原有的Requests "Mizuki" Mode和Browser "Otako" Mode，提供：

- ✅ **统一界面**: 一个Web界面管理所有下载模式
- ✅ **智能选择**: 根据使用环境选择最佳下载模式  
- ✅ **代码复用**: 避免重复维护，提高开发效率
- ✅ **完整功能**: 保留所有v1版本的功能
- ✅ **易于扩展**: 未来可轻松添加新的下载模式

### 🎯 双模式支持

#### 📊 Requests "Mizuki" Mode
**适用场景**: 个人电脑环境，追求下载速度
- ✅ 下载速度快，内存占用少
- ✅ 无需浏览器依赖
- ❌ 可能遇到文件加密问题

#### 🌐 Browser "Otako" Mode
**适用场景**: 企业办公环境，有安全软件限制
- ✅ 避免文件加密问题
- ✅ 兼容企业安全软件
- ❌ 需要Chrome浏览器，速度相对较慢

### 🚀 快速开始
```bash
# 启动v2统一版本
start_web_hysilens.bat

# 访问地址
http://localhost:31346
```

## 核心功能

- 🚀 **全市场支持**: 支持A股（主板、科创板、创业板）、港股、美股。
- 💡 **智能识别**: 自动根据股票代码格式识别市场及板块。
- 📥 **批量下载**: 支持通过Web界面或命令行进行批量下载。
- 📅 **灵活年份**: 支持单年份、年份范围或不连续年份列表。
- ✨ **现代化Web界面**: 操作直观，实时反馈进度、日志和结果。
- 📄 **多格式支持**: A股和港股下载为PDF格式，美股下载为HTML格式的10-K报告。
- 📈 **详细报告**: 任务完成后提供详细的下载统计与失败原因分析。
- 🔒 **企业友好**: 浏览器模式完美适配企业安全环境。

## 🔍 支持的股票类型

### A股市场
- **主板**: 6位数字代码
  - 上海主板: `600XXX`, `601XXX`, `603XXX`, `605XXX` (如: `600519` 贵州茅台)
  - 深圳主板: `000XXX`, `001XXX`, `002XXX` (如: `000001` 平安银行)

- **科创板**: `688XXX` 开头
  - 示例: `688111` 金山办公, `688036` 传音控股

- **创业板**: `300XXX` 开头  
  - 示例: `300750` 宁德时代, `300122` 智飞生物

### 港股市场
- **代码格式**: 5位数字代码 (前面补零)
  - 示例: `00700` 腾讯控股, `00939` 建设银行, `01810` 小米集团

### 美股市场
- **代码格式**: 字母代码 (1-5位字母)
  - 示例: `AAPL` 苹果, `MSFT` 微软, `GOOGL` 谷歌, `TSLA` 特斯拉

## ℹ️ 数据来源说明

### A股和港股
- **数据来源**: [巨潮资讯网](http://www.cninfo.com.cn/)
- **下载格式**: PDF
- **覆盖范围**: 
  - A股: 完整覆盖主板、科创板、创业板
  - 港股: 覆盖主要股票，部分可能存在缺漏

⚠️ **港股注意事项**: 由于巨潮资讯网对港股的覆盖未必完整，部分港股年报可能存在缺漏，需要手动补全。

### 美股
- **数据来源**: [美国证券交易委员会 (SEC)](https://www.sec.gov/)
- **下载格式**: HTML (10-K 报告)
- **覆盖范围**: 所有在美国注册的上市公司

### 代码格式示例

```
# A股示例
000001        # 平安银行 (深圳主板)
600519        # 贵州茅台 (上海主板) 
688111        # 金山办公 (科创板)
300750        # 宁德时代 (创业板)

# 港股示例  
00700         # 腾讯控股
00939         # 建设银行
01810         # 小米集团

# 美股示例
AAPL          # 苹果
MSFT          # 微软
GOOGL         # 谷歌
TSLA          # 特斯拉
```

## 部署与安装

#### 1. 基础环境

- **Python**: 3.7+
- **自动安装依赖**: 各版本的启动脚本 (`.bat`) 会自动检测并安装所需依赖包。

#### 2. 浏览器与驱动 (用于部分市场)

A股的科创板、创业板以及港股的下载依赖于 [Selenium](https://www.selenium.dev/) 自动化浏览器操作。

- **浏览器**: 请确保您已安装 **Google Chrome** 浏览器。
- **驱动程序 (ChromeDriver)**:
    - **自动安装**: 脚本在首次运行时会尝试自动下载与您Chrome版本匹配的ChromeDriver。**请优先尝试此方式。**
    - **手动安装**: 如果自动下载失败，请参考 `README.html` 中的详细手动安装步骤。

---

## 使用指南

### 🖥️ Web界面使用 (v2统一版本 - 推荐)

**v2版本**提供了最简单直观的使用方式。

1. **启动服务**:
   - 在项目根目录下，直接双击运行 `start_web_hysilens.bat`。
   - 脚本会自动检查环境、安装依赖，并启动Web服务器。

2. **访问界面**:
   - 脚本启动后，会自动在浏览器中打开 `http://localhost:31346`。
   - 你也可以在局域网内通过 `http://[运行电脑IP]:31346` 访问。

3. **使用步骤**:
   - **选择模式**: 根据你的网络环境选择 `Requests "Mizuki" Mode` 或 `Browser "Otako" Mode`。
   - **输入代码**: 在文本框中输入股票代码，支持每行一个或用逗号分隔。
   - **选择年份**: 输入需要下载的年份，多个年份用逗号分隔。
   - **点击下载**: 点击"开始下载"按钮，即可在下方实时查看进度和日志。

### ⚙️ 模式选择指南

不知道如何选择下载模式？请参考下表：

| 特性 | Mizuki Mode (请求模式) | Otako Mode (浏览器模式) |
| :--- | :--- | :--- |
| **核心技术** | HTTP Requests | Selenium Webdriver |
| **下载速度** | ⚡ **快** | ⭐ 常规 |
| **企业环境兼容性**| 较低 (可能被拦截) | ✅ **高** |
| **适用场景** | 个人电脑、服务器 | 企业办公环境 |

**一句话总结:** **个人用Mizuki，公司用Otako**。

### 📚 v1版本访问 (Legacy)

v1的两个独立版本已作为备份保留。如需使用，请进入`v1/`文件夹：

```bash
cd v1
```
- **Mizuki版本**: 运行 `start_web_rq.bat` (端口 `31015`)
- **Otako版本**: 运行 `start_web_bd.bat` (端口 `30331`)

---

## 📁 项目结构

```
annual_report_crawler/
├── 📄 README.md                 # 项目说明文档
├── 📄 README.html                # 网页版说明文档
├── 🐍 annual_report_downloader_hysilens.py  # v2版核心下载逻辑
├── 🌐 web_app_hysilens.py        # v2版Web应用
├── 🚀 start_web_hysilens.bat    # v2版启动脚本
├── 📁 templates/
│   └── 📄 index_hysilens.html    # v2版前端页面
├── 📦 v1/                        # v1旧版文件备份
│   ├── ... (v1版本相关文件)
├── ⚙️ chromedriver.exe            # 浏览器驱动
├── 📋 requirements.txt           # Python依赖包
└── 📂 annual_reports/           # (自动生成) 下载报告存放目录
```

## 🆚 版本对比

| 特性 | v1版本 (独立双版本) | v2统一版本 (Hysilens) |
| :--- | :--- | :--- |
| **界面数量** | 2个 (Mizuki, Otako) | ✅ **1个统一界面** |
| **代码维护** | 重复代码多，维护困难 | ✅ **代码复用高，易于维护** |
| **模式切换** | 需重启不同应用 | ✅ **界面实时切换，无需重启** |
| **端口管理** | 2个端口 (30331, 31015) | ✅ **单一端口 (31346)** |
| **扩展性** | 困难 | ✅ **易于扩展新模式** |

---

**Developed by Terence WANG**
